;============================================================================
; highpass
;
;
;============================================================================
function highpass, x


return, x - smooth(x,10)

 nn = n_elements(x)/2

 y = [dindgen(nn), dindgen(nn)-nn]  
 y[nn+1:2*nn-1] = reverse(y[0:nn-2])  


 filter = 1d/(1+(y/40d)^10) 
 xx = double(fft(fft(x,1)*(1d - filter),-1)) 

 return, xx
end
;============================================================================
